<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ElectroValve Pro - B2B Market Segmentation Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .drag-item {
            transition: all 0.2s ease;
        }
        .drag-item:hover {
            transform: scale(1.02);
        }
        .drag-item.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }
        .drop-zone {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .drop-zone:hover {
            transform: scale(1.02);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .drop-zone.drag-over {
            background-color: #dbeafe;
            border-color: #3b82f6;
            transform: scale(1.02);
        }
        .correct-drop {
            animation: correctPulse 0.6s ease-in-out;
        }
        .incorrect-drop {
            animation: incorrectShake 0.6s ease-in-out;
        }
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); background-color: #dcfce7; }
        }
        @keyframes incorrectShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        .progress-bar {
            transition: width 0.5s ease-in-out;
        }
        .celebration {
            animation: celebrate 1s ease-in-out;
        }
        @keyframes celebrate {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        .expanded-modal {
            backdrop-filter: blur(5px);
        }
        .expanded-widget {
            animation: expandIn 0.3s ease-out;
        }
        @keyframes expandIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .tick-item {
            transition: all 0.2s ease;
        }
        .tick-item:hover {
            background-color: #f0f9ff;
            transform: translateX(5px);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-4">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-8">
            <div class="flex items-center justify-center mb-4">
                <div class="bg-green-600 text-white p-3 rounded-full mr-3">
                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                </div>
                <h1 class="text-4xl font-bold text-gray-800">AGRITECK</h1>
            </div>
            <p class="text-xl text-gray-600 mb-2">Agriculture Market Analysis</p>
            <p class="text-sm text-gray-500">Categorize key factors for autonomous electrovalves in agriculture</p>
        </div>

        <!-- Company Info Banner -->
        <div class="bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-xl p-6 mb-6 shadow-lg">
            <div class="flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold mb-2">üåæ Smart Agriculture Solutions</h2>
                    <p class="text-green-100">Autonomous electrovalves for precision irrigation and smart farming</p>
                </div>
                <div class="text-right">
                    <div class="text-3xl mb-2">üíß</div>
                    <div class="text-sm">Water Smart</div>
                </div>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="bg-white rounded-lg p-4 mb-6 shadow-lg">
            <div class="flex justify-between items-center mb-2">
                <span class="text-sm font-medium text-gray-700">Agriculture Analysis Progress</span>
                <span id="score" class="text-sm font-medium text-gray-700">0/16</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-3">
                <div id="progress-bar" class="progress-bar bg-gradient-to-r from-green-400 to-emerald-500 h-3 rounded-full" style="width: 0%"></div>
            </div>
        </div>

        <!-- Feedback Zone -->
        <div id="feedback" class="text-center mb-6 h-8">
            <!-- Feedback messages will appear here -->
        </div>

        <!-- Agriculture Market Analysis (Drop Zones) -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-4 mb-8">
            <div class="drop-zone bg-white rounded-xl p-4 shadow-lg border-2 border-dashed border-green-300 min-h-80" data-category="strengths" onclick="expandCategory('strengths')">
                <div class="text-center mb-4">
                    <div class="text-3xl mb-2">üí™</div>
                    <h3 class="text-lg font-bold text-green-700">Strengths</h3>
                    <p class="text-xs text-gray-600">Internal advantages</p>
                    <p class="text-xs text-blue-500 mt-2">Click to expand details</p>
                </div>
                <div class="dropped-items space-y-2"></div>
            </div>

            <div class="drop-zone bg-white rounded-xl p-4 shadow-lg border-2 border-dashed border-blue-300 min-h-80" data-category="opportunities" onclick="expandCategory('opportunities')">
                <div class="text-center mb-4">
                    <div class="text-3xl mb-2">üöÄ</div>
                    <h3 class="text-lg font-bold text-blue-700">Opportunities</h3>
                    <p class="text-xs text-gray-600">External growth potential</p>
                    <p class="text-xs text-blue-500 mt-2">Click to expand details</p>
                </div>
                <div class="dropped-items space-y-2"></div>
            </div>

            <div class="drop-zone bg-white rounded-xl p-4 shadow-lg border-2 border-dashed border-orange-300 min-h-80" data-category="challenges" onclick="expandCategory('challenges')">
                <div class="text-center mb-4">
                    <div class="text-3xl mb-2">‚ö°</div>
                    <h3 class="text-lg font-bold text-orange-700">Challenges</h3>
                    <p class="text-xs text-gray-600">Internal obstacles</p>
                    <p class="text-xs text-blue-500 mt-2">Click to expand details</p>
                </div>
                <div class="dropped-items space-y-2"></div>
            </div>

            <div class="drop-zone bg-white rounded-xl p-4 shadow-lg border-2 border-dashed border-red-300 min-h-80" data-category="risks" onclick="expandCategory('risks')">
                <div class="text-center mb-4">
                    <div class="text-3xl mb-2">‚ö†Ô∏è</div>
                    <h3 class="text-lg font-bold text-red-700">Risks</h3>
                    <p class="text-xs text-gray-600">External threats</p>
                    <p class="text-xs text-blue-500 mt-2">Click to expand details</p>
                </div>
                <div class="dropped-items space-y-2"></div>
            </div>
        </div>

        <!-- Market Factors to Categorize -->
        <div class="bg-white rounded-xl p-6 shadow-lg">
            <h3 class="text-xl font-bold text-gray-800 mb-4 text-center">üéØ Agriculture Market Factors to Analyze</h3>
            <div id="usecases-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3">
                <!-- Market factors will be generated here -->
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-center space-x-4 mt-6">
            <button id="reset-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all duration-300 transform hover:scale-105">
                üîÑ Reset Game
            </button>
            <button id="insights-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all duration-300 transform hover:scale-105">
                üìä Agriculture Insights
            </button>
        </div>

        <!-- Expanded Category Modal -->
        <div id="expanded-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 expanded-modal flex items-center justify-center z-50">
            <div class="bg-white rounded-xl p-8 max-w-4xl mx-4 max-h-96 overflow-y-auto expanded-widget">
                <div class="flex justify-between items-center mb-6">
                    <h3 id="expanded-title" class="text-3xl font-bold"></h3>
                    <button onclick="closeExpanded()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                <div id="expanded-content" class="space-y-4">
                    <!-- Detailed content will be inserted here -->
                </div>
            </div>
        </div>

        <!-- Agriculture Insights Modal -->
        <div id="insights-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-xl p-8 max-w-3xl mx-4 max-h-96 overflow-y-auto">
                <h3 class="text-2xl font-bold mb-4">üåæ Agriculture Market Analysis Summary</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                    <div class="bg-green-50 p-4 rounded-lg">
                        <h4 class="font-bold text-green-800 mb-2">üí™ Key Strengths</h4>
                        <p class="text-green-700">IoT technology leadership, water efficiency focus, precision agriculture alignment, and scalable solutions.</p>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-bold text-blue-800 mb-2">üöÄ Major Opportunities</h4>
                        <p class="text-blue-700">Growing smart farming adoption, water scarcity concerns, government incentives, and sustainability trends.</p>
                    </div>
                    <div class="bg-orange-50 p-4 rounded-lg">
                        <h4 class="font-bold text-orange-800 mb-2">‚ö° Internal Challenges</h4>
                        <p class="text-orange-700">High R&D costs, farmer education needs, seasonal demand, and technical complexity.</p>
                    </div>
                    <div class="bg-red-50 p-4 rounded-lg">
                        <h4 class="font-bold text-red-800 mb-2">‚ö†Ô∏è External Risks</h4>
                        <p class="text-red-700">Weather dependency, commodity price volatility, regulatory changes, and competitive pressure.</p>
                    </div>
                </div>
                <button onclick="closeInsights()" class="mt-4 bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Agriculture Market Analysis Data
        const marketFactors = [
            // Strengths (4 items)
            { name: 'IoT Technology Leadership', description: 'Advanced wireless connectivity and sensors', category: 'strengths', icon: 'üì°' },
            { name: 'Water Efficiency Focus', description: 'Reduces water waste by 30-40%', category: 'strengths', icon: 'üíß' },
            { name: 'Precision Agriculture Fit', description: 'Aligns with smart farming trends', category: 'strengths', icon: 'üéØ' },
            { name: 'Scalable Solutions', description: 'Works from small farms to large operations', category: 'strengths', icon: 'üìà' },
            
            // Opportunities (4 items)
            { name: 'Growing Smart Farming', description: 'Market growing 15% annually', category: 'opportunities', icon: 'üå±' },
            { name: 'Water Scarcity Concerns', description: 'Increasing demand for conservation', category: 'opportunities', icon: 'üèúÔ∏è' },
            { name: 'Government Incentives', description: 'Subsidies for sustainable tech', category: 'opportunities', icon: 'üèõÔ∏è' },
            { name: 'Sustainability Trends', description: 'ESG requirements driving adoption', category: 'opportunities', icon: '‚ôªÔ∏è' },
            
            // Challenges (4 items)
            { name: 'High R&D Costs', description: 'Significant investment in development', category: 'challenges', icon: 'üí∞' },
            { name: 'Farmer Education Needs', description: 'Training required for adoption', category: 'challenges', icon: 'üìö' },
            { name: 'Seasonal Demand', description: 'Revenue concentrated in growing seasons', category: 'challenges', icon: 'üìÖ' },
            { name: 'Simple Assembly Design', description: 'Efficient power for open/close + sensor integration', category: 'challenges', icon: '‚öôÔ∏è' },
            
            // Risks (4 items)
            { name: 'Weather Dependency', description: 'Climate affects market demand', category: 'risks', icon: 'üå¶Ô∏è' },
            { name: 'Commodity Price Volatility', description: 'Farm income affects purchasing power', category: 'risks', icon: 'üìä' },
            { name: 'Regulatory Changes', description: 'Water usage regulations may shift', category: 'risks', icon: 'üìã' },
            { name: 'Competitive Pressure', description: 'Large agtech companies entering market', category: 'risks', icon: 'üè¢' }
        ];

        // Detailed information for each category
        const categoryDetails = {
            strengths: {
                title: 'üí™ Strengths - Internal Advantages',
                color: 'green',
                items: [
                    '‚úì Advanced IoT connectivity enables real-time monitoring',
                    '‚úì Proven water savings of 30-40% in field tests',
                    '‚úì Perfect timing with precision agriculture adoption',
                    '‚úì Modular design works for any farm size',
                    '‚úì Strong technical team with IoT expertise',
                    '‚úì Patent-pending valve control algorithms'
                ]
            },
            opportunities: {
                title: 'üöÄ Opportunities - External Growth Potential',
                color: 'blue',
                items: [
                    '‚úì Smart farming market growing 15% annually until 2028',
                    '‚úì Water scarcity driving demand for conservation tech',
                    '‚úì Government subsidies available for sustainable agriculture',
                    '‚úì ESG requirements pushing corporate farm adoption',
                    '‚úì Climate change increasing irrigation needs',
                    '‚úì Labor shortages driving automation demand'
                ]
            },
            challenges: {
                title: '‚ö° Challenges - Internal Obstacles',
                color: 'orange',
                items: [
                    '‚Ä¢ High upfront R&D investment required',
                    '‚Ä¢ Farmers need training on new technology',
                    '‚Ä¢ Sales concentrated in planting/growing seasons',
                    '‚Ä¢ Simple assembly while maintaining functionality',
                    '‚Ä¢ Balancing cost vs. feature complexity',
                    '‚Ä¢ Building trust with traditional farmers'
                ]
            },
            risks: {
                title: '‚ö†Ô∏è Risks - External Threats',
                color: 'red',
                items: [
                    '‚Ä¢ Weather patterns affect irrigation demand',
                    '‚Ä¢ Commodity prices impact farmer purchasing power',
                    '‚Ä¢ Water regulations could change requirements',
                    '‚Ä¢ Large agtech companies entering market',
                    '‚Ä¢ Economic downturns reduce farm investments',
                    '‚Ä¢ Technology obsolescence risk'
                ]
            }
        };

        let score = 0;
        let totalFactors = marketFactors.length;

        // Feedback messages
        const correctMessages = [
            "Excellent analysis! üéØ", "Perfect categorization! üìà", "Great strategic insight! üí°", 
            "Spot on! üåü", "Outstanding! üöÄ", "Strategic thinking! üß†"
        ];

        const incorrectMessages = [
            "Consider if this is internal or external ü§î", 
            "Think about positive vs negative impact üí≠",
            "Review the factor characteristics üîç",
            "Analyze the market factor more carefully üìä"
        ];

        // Expand category function
        function expandCategory(category) {
            const modal = document.getElementById('expanded-modal');
            const title = document.getElementById('expanded-title');
            const content = document.getElementById('expanded-content');
            
            const details = categoryDetails[category];
            title.textContent = details.title;
            
            content.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    ${details.items.map(item => `
                        <div class="tick-item bg-${details.color}-50 border-l-4 border-${details.color}-400 p-4 rounded-r-lg">
                            <p class="text-${details.color}-800 font-medium">${item}</p>
                        </div>
                    `).join('')}
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // Expand individual factor function
        function expandFactor(factor) {
            const modal = document.getElementById('expanded-modal');
            const title = document.getElementById('expanded-title');
            const content = document.getElementById('expanded-content');
            
            const categoryInfo = {
                strengths: { color: 'green', type: 'Internal Advantage' },
                opportunities: { color: 'blue', type: 'External Opportunity' },
                challenges: { color: 'orange', type: 'Internal Challenge' },
                risks: { color: 'red', type: 'External Risk' }
            };
            
            const info = categoryInfo[factor.category];
            title.innerHTML = `${factor.icon} ${factor.name}`;
            
            content.innerHTML = `
                <div class="bg-${info.color}-50 border-l-4 border-${info.color}-400 p-6 rounded-r-lg mb-6">
                    <div class="flex items-center mb-4">
                        <span class="text-2xl mr-3">${factor.icon}</span>
                        <div>
                            <h4 class="text-xl font-bold text-${info.color}-800">${factor.name}</h4>
                            <p class="text-${info.color}-600 text-sm">${info.type}</p>
                        </div>
                    </div>
                    <p class="text-${info.color}-700 text-lg mb-4">${factor.description}</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-white p-4 rounded-lg">
                            <h5 class="font-bold text-${info.color}-800 mb-2">üìä Market Impact</h5>
                            <p class="text-sm text-gray-700">${getMarketImpact(factor.name)}</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg">
                            <h5 class="font-bold text-${info.color}-800 mb-2">üéØ Strategic Focus</h5>
                            <p class="text-sm text-gray-700">${getStrategicFocus(factor.name)}</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg">
                            <h5 class="font-bold text-${info.color}-800 mb-2">üìà Priority Level</h5>
                            <p class="text-sm text-gray-700">${getPriorityLevel(factor.name)}</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg">
                            <h5 class="font-bold text-${info.color}-800 mb-2">‚è±Ô∏è Timeline</h5>
                            <p class="text-sm text-gray-700">${getTimeline(factor.name)}</p>
                        </div>
                    </div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // Helper functions for factor details
        function getMarketImpact(factorName) {
            const impacts = {
                'IoT Technology Leadership': 'High competitive advantage in smart agriculture market',
                'Water Efficiency Focus': 'Direct cost savings for farmers, strong value proposition',
                'Precision Agriculture Fit': 'Aligns with $12B precision agriculture market growth',
                'Scalable Solutions': 'Addressable market from small farms to enterprise agriculture',
                'Growing Smart Farming': 'Market size expected to reach $15.3B by 2025',
                'Water Scarcity Concerns': 'Global water crisis driving adoption urgency',
                'Government Incentives': 'Up to 30% cost reduction through subsidies',
                'Sustainability Trends': 'ESG compliance becoming mandatory for large farms',
                'High R&D Costs': 'Significant capital requirements may limit development speed',
                'Farmer Education Needs': 'Adoption barriers requiring extensive training programs',
                'Seasonal Demand': 'Revenue concentration in 6-month growing periods',
                'Simple Assembly Design': 'Balance between functionality and ease of installation',
                'Weather Dependency': 'Climate variability affects irrigation demand patterns',
                'Commodity Price Volatility': 'Farm income fluctuations impact purchasing decisions',
                'Regulatory Changes': 'Water usage policies may shift market requirements',
                'Competitive Pressure': 'Large players entering with significant resources'
            };
            return impacts[factorName] || 'Moderate impact on market positioning';
        }

        function getStrategicFocus(factorName) {
            const focuses = {
                'IoT Technology Leadership': 'Leverage technology advantage for market differentiation',
                'Water Efficiency Focus': 'Emphasize ROI and sustainability benefits in marketing',
                'Precision Agriculture Fit': 'Partner with precision agriculture platforms',
                'Scalable Solutions': 'Develop tiered product offerings for different farm sizes',
                'Growing Smart Farming': 'Accelerate market entry to capture growth',
                'Water Scarcity Concerns': 'Position as essential water conservation tool',
                'Government Incentives': 'Align product features with subsidy requirements',
                'Sustainability Trends': 'Develop ESG reporting and certification features',
                'High R&D Costs': 'Optimize development process and seek strategic partnerships',
                'Farmer Education Needs': 'Invest in training programs and user-friendly design',
                'Seasonal Demand': 'Develop off-season revenue streams and financing options',
                'Simple Assembly Design': 'Focus on plug-and-play installation experience',
                'Weather Dependency': 'Develop weather-adaptive algorithms and forecasting',
                'Commodity Price Volatility': 'Offer flexible pricing and financing models',
                'Regulatory Changes': 'Build adaptable platform for regulatory compliance',
                'Competitive Pressure': 'Focus on niche markets and unique value propositions'
            };
            return focuses[factorName] || 'Monitor and adapt strategy accordingly';
        }

        function getPriorityLevel(factorName) {
            const priorities = {
                'IoT Technology Leadership': 'High - Core competitive advantage',
                'Water Efficiency Focus': 'High - Primary value proposition',
                'Precision Agriculture Fit': 'Medium - Market alignment opportunity',
                'Scalable Solutions': 'Medium - Growth enabler',
                'Growing Smart Farming': 'High - Market timing critical',
                'Water Scarcity Concerns': 'High - Urgent market need',
                'Government Incentives': 'Medium - Financial opportunity',
                'Sustainability Trends': 'Medium - Long-term positioning',
                'High R&D Costs': 'High - Resource allocation critical',
                'Farmer Education Needs': 'Medium - Adoption barrier',
                'Seasonal Demand': 'Medium - Revenue planning important',
                'Simple Assembly Design': 'High - User experience critical',
                'Weather Dependency': 'Low - External factor to monitor',
                'Commodity Price Volatility': 'Medium - Pricing strategy impact',
                'Regulatory Changes': 'Medium - Compliance requirement',
                'Competitive Pressure': 'High - Market position threat'
            };
            return priorities[factorName] || 'Medium - Standard monitoring';
        }

        function getTimeline(factorName) {
            const timelines = {
                'IoT Technology Leadership': 'Ongoing - Continuous innovation required',
                'Water Efficiency Focus': 'Immediate - Core to current product',
                'Precision Agriculture Fit': '6-12 months - Partnership development',
                'Scalable Solutions': '3-6 months - Product line expansion',
                'Growing Smart Farming': 'Immediate - Market entry window',
                'Water Scarcity Concerns': 'Ongoing - Long-term trend',
                'Government Incentives': '3-6 months - Policy alignment',
                'Sustainability Trends': '12-24 months - Feature development',
                'High R&D Costs': 'Ongoing - Budget management',
                'Farmer Education Needs': '6-12 months - Program development',
                'Seasonal Demand': 'Ongoing - Annual planning cycle',
                'Simple Assembly Design': '3-6 months - Design optimization',
                'Weather Dependency': 'Ongoing - Continuous monitoring',
                'Commodity Price Volatility': 'Ongoing - Market adaptation',
                'Regulatory Changes': '12-24 months - Policy monitoring',
                'Competitive Pressure': 'Immediate - Competitive response'
            };
            return timelines[factorName] || '6-12 months - Standard timeline';
        }

        function closeExpanded() {
            document.getElementById('expanded-modal').classList.add('hidden');
        }

        // Initialize the game
        function initGame() {
            const container = document.getElementById('usecases-container');
            container.innerHTML = '';
            
            // Shuffle market factors
            const shuffledFactors = [...marketFactors].sort(() => Math.random() - 0.5);
            
            shuffledFactors.forEach((factor, index) => {
                const factorElement = document.createElement('div');
                factorElement.className = 'drag-item bg-gradient-to-br from-gray-50 to-gray-100 p-3 rounded-lg shadow-md cursor-move border-2 border-gray-200 hover:border-green-300';
                factorElement.draggable = true;
                factorElement.dataset.category = factor.category;
                factorElement.dataset.name = factor.name;
                factorElement.innerHTML = `
                    <div class="text-center">
                        <div class="text-xl mb-1">${factor.icon}</div>
                        <div class="text-xs font-bold text-gray-800 mb-1">${factor.name}</div>
                        <div class="text-xs text-gray-600">${factor.description}</div>
                        <div class="text-xs text-blue-500 mt-1">Click for details</div>
                    </div>
                `;
                
                // Drag and drop events
                factorElement.addEventListener('dragstart', handleDragStart);
                factorElement.addEventListener('dragend', handleDragEnd);
                
                // Click event for expansion
                factorElement.addEventListener('click', (e) => {
                    if (!factorElement.classList.contains('dragging')) {
                        expandFactor(factor);
                    }
                });
                
                container.appendChild(factorElement);
            });

            // Reset score
            score = 0;
            updateProgress();
            clearFeedback();
        }

        // Drag and drop handling
        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', '');
            e.target.classList.add('dragging');
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        // Setup drop zones
        document.querySelectorAll('.drop-zone').forEach(zone => {
            zone.addEventListener('dragover', handleDragOver);
            zone.addEventListener('drop', handleDrop);
            zone.addEventListener('dragenter', handleDragEnter);
            zone.addEventListener('dragleave', handleDragLeave);
        });

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDragEnter(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            if (!e.currentTarget.contains(e.relatedTarget)) {
                e.currentTarget.classList.remove('drag-over');
            }
        }

        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation(); // Prevent triggering the click event
            const zone = e.currentTarget;
            zone.classList.remove('drag-over');
            
            const draggedElement = document.querySelector('.dragging');
            if (!draggedElement) return;

            const factorCategory = draggedElement.dataset.category;
            const zoneCategory = zone.dataset.category;
            const factorName = draggedElement.dataset.name;

            if (factorCategory === zoneCategory) {
                // Correct answer
                zone.classList.add('correct-drop');
                setTimeout(() => zone.classList.remove('correct-drop'), 600);
                
                // Move factor to zone
                const droppedItems = zone.querySelector('.dropped-items');
                draggedElement.className = 'bg-green-100 border-green-300 p-2 rounded-lg text-xs font-medium text-green-800 border-2';
                draggedElement.draggable = false;
                droppedItems.appendChild(draggedElement);
                
                score++;
                updateProgress();
                showFeedback(correctMessages[Math.floor(Math.random() * correctMessages.length)], 'correct');
                
                // Check if game is complete
                if (score === totalFactors) {
                    setTimeout(() => {
                        showFeedback("üéä Excellent! You've completed the agriculture market analysis! üéä", 'celebration');
                        document.getElementById('progress-bar').classList.add('celebration');
                    }, 500);
                }
            } else {
                // Incorrect answer
                zone.classList.add('incorrect-drop');
                setTimeout(() => zone.classList.remove('incorrect-drop'), 600);
                showFeedback(incorrectMessages[Math.floor(Math.random() * incorrectMessages.length)], 'incorrect');
            }
        }

        function updateProgress() {
            const progressBar = document.getElementById('progress-bar');
            const scoreElement = document.getElementById('score');
            const percentage = (score / totalFactors) * 100;
            
            progressBar.style.width = percentage + '%';
            scoreElement.textContent = `${score}/${totalFactors}`;
        }

        function showFeedback(message, type) {
            const feedback = document.getElementById('feedback');
            feedback.innerHTML = `<div class="text-lg font-medium ${type === 'correct' ? 'text-green-600' : type === 'celebration' ? 'text-purple-600' : 'text-orange-600'}">${message}</div>`;
            
            setTimeout(() => {
                if (type !== 'celebration') {
                    clearFeedback();
                }
            }, 3000);
        }

        function clearFeedback() {
            document.getElementById('feedback').innerHTML = '';
        }

        // Reset button
        document.getElementById('reset-btn').addEventListener('click', () => {
            document.querySelectorAll('.dropped-items').forEach(container => {
                container.innerHTML = '';
            });
            initGame();
        });

        // Insights button
        document.getElementById('insights-btn').addEventListener('click', () => {
            document.getElementById('insights-modal').classList.remove('hidden');
        });

        function closeInsights() {
            document.getElementById('insights-modal').classList.add('hidden');
        }

        // Initialize game on load
        initGame();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'971af814665ae1aa',t:'MTc1NTYyMDMyOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

